<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Craft Prospect: MultiCNN_v2 Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Craft Prospect
   </div>
   <div id="projectbrief">Satellite imagery neural networks</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">MultiCNN_v2 Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Creates the multi class neural network model, based on VGG19, and fits to the data input, uses 4 classes.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a83dc4919275a5410136cee73cb19f92b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_multi_c_n_n__v2.html#a83dc4919275a5410136cee73cb19f92b">createModel</a> ()</td></tr>
<tr class="separator:a83dc4919275a5410136cee73cb19f92b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4434c0bf394899e4c2ec7d3422476b2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_multi_c_n_n__v2.html#ad4434c0bf394899e4c2ec7d3422476b2">compileModel</a> (model)</td></tr>
<tr class="separator:ad4434c0bf394899e4c2ec7d3422476b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f52a86fb65856424ff25afb925ee9b2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_multi_c_n_n__v2.html#a0f52a86fb65856424ff25afb925ee9b2">fitModel</a> (model)</td></tr>
<tr class="separator:a0f52a86fb65856424ff25afb925ee9b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8843e65d718b70b0028cec93bd715890"><td class="memItemLeft" align="right" valign="top"><a id="a8843e65d718b70b0028cec93bd715890"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>NUM_CLASSES</b> = 4</td></tr>
<tr class="separator:a8843e65d718b70b0028cec93bd715890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad61b382642585fa5d8e9878014ceb526"><td class="memItemLeft" align="right" valign="top"><a id="ad61b382642585fa5d8e9878014ceb526"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>IMG_SIZE</b> = 64</td></tr>
<tr class="separator:ad61b382642585fa5d8e9878014ceb526"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bef3f1af201f1741f553d4efd4dfee4"><td class="memItemLeft" align="right" valign="top"><a id="a8bef3f1af201f1741f553d4efd4dfee4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>batch_size</b> = 32</td></tr>
<tr class="separator:a8bef3f1af201f1741f553d4efd4dfee4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a344f335bb12508be3903c57f352a7994"><td class="memItemLeft" align="right" valign="top"><a id="a344f335bb12508be3903c57f352a7994"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>epochs</b> = 40</td></tr>
<tr class="separator:a344f335bb12508be3903c57f352a7994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f9133e4df59d711a80cead4bbb06f99"><td class="memItemLeft" align="right" valign="top"><a id="a1f9133e4df59d711a80cead4bbb06f99"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>lr</b> = 0.001</td></tr>
<tr class="separator:a1f9133e4df59d711a80cead4bbb06f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd624c17d858da08748284a4f394294"><td class="memItemLeft" align="right" valign="top"><a id="a4dd624c17d858da08748284a4f394294"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>nb_train_samples</b> = 4000</td></tr>
<tr class="separator:a4dd624c17d858da08748284a4f394294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab617056f2937d90e24c36548385b4430"><td class="memItemLeft" align="right" valign="top"><a id="ab617056f2937d90e24c36548385b4430"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>nb_validation_samples</b> = 400</td></tr>
<tr class="separator:ab617056f2937d90e24c36548385b4430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dd0a6d06ce20b10465366a6717b749c"><td class="memItemLeft" align="right" valign="top"><a id="a8dd0a6d06ce20b10465366a6717b749c"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>TRAIN_DATA_PATH</b> = ''</td></tr>
<tr class="separator:a8dd0a6d06ce20b10465366a6717b749c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47172760b33c05da734894865e1a0fed"><td class="memItemLeft" align="right" valign="top"><a id="a47172760b33c05da734894865e1a0fed"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>VALIDATION_DATA_PATH</b> = ''</td></tr>
<tr class="separator:a47172760b33c05da734894865e1a0fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21fd238c4120fe1a61cddd09444342e1"><td class="memItemLeft" align="right" valign="top"><a id="a21fd238c4120fe1a61cddd09444342e1"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>model</b> = <a class="el" href="namespace_multi_c_n_n__v2.html#a83dc4919275a5410136cee73cb19f92b">createModel</a>()</td></tr>
<tr class="separator:a21fd238c4120fe1a61cddd09444342e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99034b0c1931c5c18b2145df37e9c0be"><td class="memItemLeft" align="right" valign="top"><a id="a99034b0c1931c5c18b2145df37e9c0be"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>compiledModel</b> = <a class="el" href="namespace_multi_c_n_n__v2.html#ad4434c0bf394899e4c2ec7d3422476b2">compileModel</a>(model)</td></tr>
<tr class="separator:a99034b0c1931c5c18b2145df37e9c0be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p class="">Creates the multi class neural network model, based on VGG19, and fits to the data input, uses 4 classes. </p>
<p class="">Used for the training of the multi class neural network. Creates a sequential neural network, and adds it's respective layers. The model is then compiled, fit to the training data, and then saved to be used by the prediction scripts Uses the VGG19 model as base layer, and includes an additional class clear_primary. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad4434c0bf394899e4c2ec7d3422476b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4434c0bf394899e4c2ec7d3422476b2">&#9670;&nbsp;</a></span>compileModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MultiCNN_v2.compileModel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes a model and compiles it using a categorical crossentropy loss function and an Adam optimizer.   </pre> 
</div>
</div>
<a id="a83dc4919275a5410136cee73cb19f92b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83dc4919275a5410136cee73cb19f92b">&#9670;&nbsp;</a></span>createModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MultiCNN_v2.createModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Loads the VGG19 pretrained neural network and uses it for the base layers. Adds a Dense layer for the output layer.
   Input -&gt; VGG19 -&gt; BatchNormalization Layer -&gt; Dense -&gt; Output. 
</pre> 
</div>
</div>
<a id="a0f52a86fb65856424ff25afb925ee9b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f52a86fb65856424ff25afb925ee9b2">&#9670;&nbsp;</a></span>fitModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MultiCNN_v2.fitModel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">takes a layered model as input and fits it with the training data.</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
